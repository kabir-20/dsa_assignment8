#include <iostream>
using namespace std;

class Node {
public:
    int data;
    Node* left;
    Node* right;
    Node(int x) {
        data = x;
        left = right = NULL;
    }
};

class BST {
public:
    Node* root;

    BST() {
        root = NULL;
    }

    Node* insert(Node* r, int x) {
        if (!r) return new Node(x);
        if (x < r->data) r->left = insert(r->left, x);
        else r->right = insert(r->right, x);
        return r;
    }

    Node* searchRec(Node* r, int x) {
        if (!r || r->data == x) return r;
        if (x < r->data) return searchRec(r->left, x);
        else return searchRec(r->right, x);
    }

    Node* searchNonRec(int x) {
        Node* t = root;
        while (t) {
            if (t->data == x) return t;
            if (x < t->data) t = t->left;
            else t = t->right;
        }
        return NULL;
    }

    Node* minNode(Node* r) {
        if (!r) return NULL;
        while (r->left) r = r->left;
        return r;
    }

    Node* maxNode(Node* r) {
        if (!r) return NULL;
        while (r->right) r = r->right;
        return r;
    }

    Node* successor(Node* r, int x) {
        Node* curr = searchRec(r, x);
        if (!curr) return NULL;
        if (curr->right) return minNode(curr->right);
        Node* succ = NULL;
        Node* anc = root;
        while (anc != curr) {
            if (curr->data < anc->data) {
                succ = anc;
                anc = anc->left;
            } else {
                anc = anc->right;
            }
        }
        return succ;
    }

    Node* predecessor(Node* r, int x) {
        Node* curr = searchRec(r, x);
        if (!curr) return NULL;
        if (curr->left) return maxNode(curr->left);
        Node* pred = NULL;
        Node* anc = root;
        while (anc != curr) {
            if (curr->data > anc->data) {
                pred = anc;
                anc = anc->right;
            } else {
                anc = anc->left;
            }
        }
        return pred;
    }
};

int main() {
    BST t;
    t.root = t.insert(t.root, 20);
    t.insert(t.root, 10);
    t.insert(t.root, 30);
    t.insert(t.root, 5);
    t.insert(t.root, 15);
    t.insert(t.root, 25);
    t.insert(t.root, 40);

    Node* s1 = t.searchRec(t.root, 15);
    Node* s2 = t.searchNonRec(25);

    Node* mn = t.minNode(t.root);
    Node* mx = t.maxNode(t.root);

    Node* suc = t.successor(t.root, 15);
    Node* pre = t.predecessor(t.root, 15);

    if (s1) cout << "Found Rec: " << s1->data
